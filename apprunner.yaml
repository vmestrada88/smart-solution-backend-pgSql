version: 1.0
runtime: nodejs16

build:
  command: corepack enable && yarn install --frozen-lockfile

run:
  command: node server.js
  network:
    port: 8000

healthCheck:
  path: /api/health
  interval: 10
  timeout: 5
  healthyThreshold: 1
  unhealthyThreshold: 3

env:
  - name: NODE_ENV
    value: production
  - name: PORT
    value: "8000"
  - name: FRONTEND_URL
    value: https://master.d3afcsxlnuerx1.amplifyapp.com

secrets:
  - name: DATABASE_URL
    value: arn:aws:secretsmanager:us-east-1:728399044804:secret:smartsolution-DATABASE_URL-REPLACE_WITH_SUFFIX
    key: DATABASE_URL
  - name: JWT_SECRET
    value: arn:aws:secretsmanager:us-east-1:728399044804:secret:smartsolution-JWT_SECRET-REPLACE_WITH_SUFFIX
    key: JWT_SECRET