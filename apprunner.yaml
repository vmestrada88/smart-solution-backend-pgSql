version: 1.0
runtime: nodejs20

build:
  commands:
    - corepack enable
    - yarn install --frozen-lockfile

run:
  command: node server.js
  network:
    port: 8000

healthCheck:
  path: /api/health
  interval: 10
  timeout: 5
  healthyThreshold: 1
  unhealthyThreshold: 3

env:
  - name: NODE_ENV
    value: production
  - name: PORT
    value: "8000"
  - name: FRONTEND_URL
    value: https://master.d3afcsxlnuerx1.amplifyapp.com

secrets:
  - name: DATABASE_URL
    value: postgres://postgres:admin123@smartsolutiondb.ccxygac26ujg.us-east-1.rds.amazonaws.com:5432/smartsolutiondb
  - name: JWT_SECRET
    value: oM7H$2rFqZ!p9vT1wC#4gL8xN@5eQ6uD